
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bidirectional LSTM Classifier &#8212; EmailClassificatie 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Pretrained BERT" href="pretrainedbert.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="bidirectional-lstm-classifier">
<h1>Bidirectional LSTM Classifier<a class="headerlink" href="#bidirectional-lstm-classifier" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="models.bilstmclassifier.BiLSTMClassifier">
<em class="property">class </em><code class="sig-prename descclassname">models.bilstmclassifier.</code><code class="sig-name descname">BiLSTMClassifier</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_outputs</span></em>, <em class="sig-param"><span class="n">hidden_dim</span><span class="o">=</span><span class="default_value">256</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">device(type='cuda')</span></em>, <em class="sig-param"><span class="n">word_embedding_path</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'C:\\Users\\ruben\\Desktop\\gemeente_deliverables\\gemeente_github_code\\EmailClassificatieSoftware/resources/word_embeddings/combined-320.tar/320/'</span></em>, <em class="sig-param"><span class="n">max_seq_len</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>This class implements a Bidirectional LSTM classifier based on the version from PyTorch
It deals with the various aspects of the training, such as converting the data into the appropriate
format and logging the training process via TensorBoard</p>
<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier.device">
<code class="sig-name descname">device</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier.device" title="Permalink to this definition">¶</a></dt>
<dd><p>torch.device indicating on which device the model and the inputs should be, either on the GPU or the
CPU. The default behaviour is to put the model and the inputs on the GPU when available.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier.model">
<code class="sig-name descname">model</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The main model used for classification, in this case the Bidirectional LSTM model</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier.num_outputs">
<code class="sig-name descname">num_outputs</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier.num_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer specifying the number of outputs of the model. This should be set to the number of unique classes
in the dataset. (the ‘get_num_labels_from_file’ method can be used to retrieve this from the csv file
when this is not known)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier.has_trained">
<code class="sig-name descname">has_trained</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier.has_trained" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean specifying whether the model has already been trained. This is used to ensure that the evaluaton
or scoring is not accidentally run on an untrained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier._TEXT">
<code class="sig-name descname">_TEXT</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier._TEXT" title="Permalink to this definition">¶</a></dt>
<dd><p>torchtext.data.Field instance specifying several parameters of the reading of the data such as
whether or not to convert all text to lowercase and the type and language of the tokenizer used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>torchtext.data.Field</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier._words">
<code class="sig-name descname">_words</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier._words" title="Permalink to this definition">¶</a></dt>
<dd><p>list with all the words present in the Dutch embedding file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier._embed_dict">
<code class="sig-name descname">_embed_dict</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier._embed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary mapping words in the embeddings file to indices into the embedding matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier._embeddings">
<code class="sig-name descname">_embeddings</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier._embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>torch.Tensor of size [num_words, embedding_dim] containing the word embeddings</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">_criterion nn.optim.Criterion</code></dt>
<dd><p>criterion used for the training and evaluation of the model. This is saved in the train methods
for later use in the evaluation methods</p>
</dd></dl>

<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier._embed_dim">
<code class="sig-name descname">_embed_dim</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier._embed_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer specifying the dimension of the embeddings used in the embedding file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="models.bilstmclassifier.BiLSTMClassifier._label_names">
<code class="sig-name descname">_label_names</code><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier._label_names" title="Permalink to this definition">¶</a></dt>
<dd><p>list containing the names of the unique labels in the dataset, this is used for converting the
integer representation used in training back to the original labels for easier interpretation</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">train_from_file(file_name, batch_size, num_epochs, delimiter, quotechar, text_col_name, label_col_name,</code></dt>
<dd></dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">learning_rate,max_seq_len, logging_dir)</code></dt>
<dd><p>The main method of this class, implementing a training procedure for the model and handling
the proper loading of the dataset</p>
</dd></dl>

<dl class="py method">
<dt id="models.bilstmclassifier.BiLSTMClassifier.classify_from_file">
<code class="sig-name descname">classify_from_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">delimiter</span></em>, <em class="sig-param"><span class="n">quotechar</span></em>, <em class="sig-param"><span class="n">text_col_name</span></em>, <em class="sig-param"><span class="n">label_col_name</span></em>, <em class="sig-param"><span class="n">batch_size</span></em><span class="sig-paren">)</span><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier.classify_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>method used for classifying a set of examples for a file with a trained classifier</p>
</dd></dl>

<dl class="py method">
<dt id="models.bilstmclassifier.BiLSTMClassifier.classify_from_strings">
<code class="sig-name descname">classify_from_strings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strings</span></em>, <em class="sig-param"><span class="n">max_seq_len</span></em><span class="sig-paren">)</span><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier.classify_from_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>method that can be used for classifying one or multiple examples with a trained classifier</p>
</dd></dl>

<dl class="py method">
<dt id="models.bilstmclassifier.BiLSTMClassifier.score">
<code class="sig-name descname">score</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">delimiter</span></em>, <em class="sig-param"><span class="n">quotechar</span></em>, <em class="sig-param"><span class="n">text_col_name</span></em>, <em class="sig-param"><span class="n">label_col_name</span></em>, <em class="sig-param"><span class="n">batch_size</span></em><span class="sig-paren">)</span><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier.score" title="Permalink to this definition">¶</a></dt>
<dd><p>method that can be used score that model on an unseen test file</p>
</dd></dl>

<dl class="py method">
<dt id="models.bilstmclassifier.BiLSTMClassifier.save_model">
<code class="sig-name descname">save_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>method that can be used to save a (trained) classifier</p>
</dd></dl>

<dl class="py method">
<dt id="models.bilstmclassifier.BiLSTMClassifier.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#models.bilstmclassifier.BiLSTMClassifier.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>method that can be used to load a classifier saved in the .pt format</p>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">EmailClassificatie</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../msc/anonymization.html">Anonymizing Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="../msc/traintestsplitting.html">Splitting Into Train and Test files</a></li>
<li class="toctree-l1"><a class="reference internal" href="tfidf.html">TF-IDF Classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="pretrainedbert.html">Pretrained BERT</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Bidirectional LSTM Classifier</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="pretrainedbert.html" title="previous chapter">Pretrained BERT</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Ruben van Heusden.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/models/bilstmclassifier.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>